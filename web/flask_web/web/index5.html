<!DOCTYPE html>
<html>
    <head>
        <title>jQuery DataTables Plugin | YogiHosting Demo</title>
        <link rel="icon" type="image/png"
            href="http://www.yogihosting.com/wp-content/themes/yogi-yogihosting/Images/favicon.ico">
        <meta charset="utf-8">
        <script
            src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <script type="text/javascript"
            src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
        <link rel="stylesheet" type="text/css" href="css/tabs.css">
        <link rel="stylesheet" type="text/css" href="css/tabstyles.css">
        <link rel="stylesheet" type="text/css"
            href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
        <!-- Loads and initializes the library -->
        <script type="text/javascript" src="js/mxClient.min.js"></script>
        <style> 
P{
    padding: 0;
}
 
body {
  background: #e7ecea;
  color: #74777b;
  font-weight: 400;
  font-size: 1em;
  font-family: 'Raleway', Arial, sans-serif;
}
.dataTables_length{display: none;}

.dataTables_filter{display: none;}

.dataTables_paginate {display: none;}

.dataTables_info {display: none;}
 #content{
    width: 50%;
    float: left;
    display: block;
 }
 #history{
    width: 50%;
    float: left;
    display: block;
 }
 .hidden{ display: none;}
        </style>
    </head>
    <body>
        <svg class="hidden">
            <defs>
                <path id="tabshape" d="M80,60C34,53.5,64.417,0,0,0v60H80z"/>
                </defs>
            </svg>
            <h1>jQuery DataTables Plugin</h1>
            <button onclick="testDraw()">Organic</button>
            <button onclick="testDraw2()">Organic2</button>
            <h2>
                <a href="http://www.yogihosting.com/jquery-datatables/">
                    Read the
                    tutorial on YogiHosting »
                </a>
                <button id="reset">Reset »</button>
            </h2>
            <div class="container">
                <div id="content">
                    <table id="table4">
                        <thead>
                            <tr>
                                <th>Id</th>
                                <th>Room</th>
                                <th>Price</th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <div id="history">
                    <div class="tabs tabs-style-shape">
                        <nav>
                            <ul>
                                <li>
                                    <a href="#section-shape-1">
                                        <svg viewBox="0 0 80 60"
                                            preserveAspectRatio="none">
                                            <use xlink:href="#tabshape"></use>
                                        </svg>
                                        <span>History</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#section-shape-2">
                                        <svg viewBox="0 0 80 60"
                                            preserveAspectRatio="none">
                                            <use xlink:href="#tabshape"></use>
                                        </svg>
                                        <svg viewBox="0 0 80 60"
                                            preserveAspectRatio="none">
                                            <use xlink:href="#tabshape"></use>
                                        </svg>
                                        <span>Graph</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                        <div class="content-wrap">
                            <section id="section-shape-1">
                                <p>
                                    <table id="tableHistory">
                                        <thead>
                                            <tr>
                                                <th>Id</th>
                                                <th>Room</th>
                                                <th>Price</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </p>
                            </section>
                            <section id="section-shape-2">
                                <p>
                                    <div id="graphContainer"
                                        style="position:absolute;overflow:auto;top:36px;bottom:0px;left:0px;right:0px;border-top:gray
                                        1px solid;"></div>
                                </p>
                            </section>
                        </div>
                        <!-- /content -->
                    </div>
                    <!-- /tabs -->
                </div>
            </div>
            <!--Reference to jQuery-->
            <script>
        $(document).ready(function () {
            $("#reset").click(function (e) {
                location.reload();
            });

          

            /*AJAX Response Binding*/
            $('#table4').DataTable({
                ajax: {
                    url: 'data.json',
                    dataSrc: "roomsData"
                },
                columns: [
                    { data: 'id' },
                    { data: 'room' },
                    {
                        type:'test333',
                        className: "my_class",
                         data: 'price' , render: function (data, type, row) {
                          console.log( this) ;
 return data+'test';
 } 
}
                ],
                "pageLength": 3
            });
            /*End*/

            
            $('#tableHistory').DataTable({
                ajax: {
                    url: 'data.json',
                    dataSrc: "roomsData"
                },
                columns: [
                    { data: 'id' },
                    { data: 'room' },
                    { data: 'price' , render: function (data, type, row) {
 return data+'test';
 } 
}
                ],
                "pageLength": 3
            });
        });
        </script>
            <script src="js/cbpFWTabs.js"></script>
            <script>
			(function() {

				[].slice.call( document.querySelectorAll( '.tabs' ) ).forEach( function( el ) {
					var t=new CBPFWTabs( el , {start: 2} );
					t.current =1;
					t._show();
				});
               
			})();
 $(function(){
    main(document.getElementById('graphContainer'))
 })

// Program starts here. Creates a sample graph in the
// DOM node with the specified ID. This function is invoked
// from the onLoad event handler of the document (see below).
var glayout ={};
var ggraph ={}; 
        var gorganic = {} ; 
        
        var gparent = {} ;
        function testDraw(){
          //  addNodes();
          addNodes(testData);
            gorganic.execute(gparent);
        }
        function testDraw2(){
          //  addNodes();
          addNodes(testData2);
            gorganic.execute(gparent);
        }
function main(container)
{
    // Checks if browser is supported
    if (!mxClient.isBrowserSupported())
    {
        // Displays an error message if the browser is
        // not supported.
        mxUtils.error('Browser is not supported!', 200, false);
    }
    else
    {
        // Creates the graph inside the given container
        ggraph = new mxGraph(container);
        
        // Adds rubberband selection
        new mxRubberband(ggraph);
        
        // Changes the default vertex style in-place
        var style = ggraph.getStylesheet().getDefaultVertexStyle();
        style[mxConstants.STYLE_PERIMETER] = mxPerimeter.RectanglePerimeter;
        style[mxConstants.STYLE_GRADIENTCOLOR] = 'white';
        style[mxConstants.STYLE_PERIMETER_SPACING] = 6;
        style[mxConstants.STYLE_ROUNDED] = true;
        style[mxConstants.STYLE_SHADOW] = true;
        
        style = ggraph.getStylesheet().getDefaultEdgeStyle();
        style[mxConstants.STYLE_ROUNDED] = true;

        // Creates a layout algorithm to be used
        // with the graph
          glayout = new mxHierarchicalLayout(ggraph);
          gorganic = new  mxOrganicLayout(ggraph);
        gorganic.forceConstant = 120;
        
          gparent = ggraph.getDefaultParent();
    
        // Adds a button to execute the layout
        var button = document.createElement('button');
        mxUtils.write(button, 'Hierarchical');
        mxEvent.addListener(button, 'click', function(evt)
        {
            layout.execute(gparent);
        });
        //document.body.appendChild(button);

        // Adds a button to execute the layout
        var button = document.createElement('button');
        mxUtils.write(button, 'Organic');
        
        mxEvent.addListener(button, 'click', function(evt)
        {
            gorganic.execute(gparent);
        });
        
       // document.body.appendChild(button);
        
    

        if (mxClient.IS_QUIRKS)
        {
            document.body.style.overflow = 'hidden';
            new mxDivResizer(container);
        }
    }
}; 

var gNodes={};
var gEdge={};

var testData= {
   "message":[
      {
         "ASSOCIATIONPATTERN_ID":187,
         "ASSOCIATIONPATTERN_ID1":187,
         "A_DN":"AR=ONT to ESA",
         "FROM_TYPE":"p",
         "LOGICALRESOURCE_UNIQUEID":null,
         "NETWORK_UNIQUEID":null,
         "N_DN":null,
         "PHYSICALRESOURCE_UNIQUEID":95365456,
         "RESOURCE_UNIQUEID":953654563,
         "R_DN":"ME=95365426",
         "R_NAME":"Optical Node Terminal",
         "R_PREFIX":"ME",
         "TO_LOGICALRESOURCE_UNIQUEID":null,
         "TO_NETWORK_UNIQUEID":null,
         "TO_PHYSICALRESOURCE_UNIQUEID":null,
         "TO_PLACE_UNIQUEID":21214022,
         "TO_P_DN":"ESA=SNTQUTMA",
         "TO_RESOURCE_UNIQUEID":null,
         "TO_R_DN":null,
         "TO_R_NAME":null,
         "TO_R_PREFIX":null,
         "TO_TYPE":null
      },
      {
         "ASSOCIATIONPATTERN_ID":464,
         "ASSOCIATIONPATTERN_ID1":464,
         "A_DN":"AR=ONT to ESP",
         "FROM_TYPE":"p",
         "LOGICALRESOURCE_UNIQUEID":null,
         "NETWORK_UNIQUEID":null,
         "N_DN":null,
         "PHYSICALRESOURCE_UNIQUEID":95365456,
         "RESOURCE_UNIQUEID":95365453,
         "R_DN":"ME=95365426",
         "R_NAME":"Optical Node Terminal",
         "R_PREFIX":"ME",
         "TO_LOGICALRESOURCE_UNIQUEID":null,
         "TO_NETWORK_UNIQUEID":null,
         "TO_PHYSICALRESOURCE_UNIQUEID":null,
         "TO_PLACE_UNIQUEID":65083834,
         "TO_P_DN":"ESP=20220422123515945336",
         "TO_RESOURCE_UNIQUEID":null,
         "TO_R_DN":null,
         "TO_R_NAME":null,
         "TO_R_PREFIX":null,
         "TO_TYPE":null
      }
   ],
   "entityInfo":[
      {  "UNIQUEID":95365456,
         "DNKEY":"ME",
         "PARENTDN":"None",
         "DISTINGUISHEDNAME":"ME=95365426",
         "ROOTDN_ENTITYID":"None",
         "ETYPE":"ET=ONT",
         "CATEGORY":"PHYSICAL_RESOURCE"
      }
   ]
};


var testData2= {
   "message":[
      {
         "ASSOCIATIONPATTERN_ID":187,
         "ASSOCIATIONPATTERN_ID1":187,
         "A_DN":"AR=ONT to ESA",
         "FROM_TYPE":"p",
         "LOGICALRESOURCE_UNIQUEID":null,
         "NETWORK_UNIQUEID":null,
         "N_DN":null,
         "PHYSICALRESOURCE_UNIQUEID":95365456,
         "RESOURCE_UNIQUEID":953654563,
         "R_DN":"ME=95365426",
         "R_NAME":"Optical Node Terminal",
         "R_PREFIX":"ME",
         "TO_LOGICALRESOURCE_UNIQUEID":null,
         "TO_NETWORK_UNIQUEID":null,
         "TO_PHYSICALRESOURCE_UNIQUEID":null,
         "TO_PLACE_UNIQUEID":21214022,
         "TO_P_DN":"ESA=SNTQUTMA",
         "TO_RESOURCE_UNIQUEID":null,
         "TO_R_DN":null,
         "TO_R_NAME":null,
         "TO_R_PREFIX":null,
         "TO_TYPE":null
      },
      {
         "ASSOCIATIONPATTERN_ID":464,
         "ASSOCIATIONPATTERN_ID1":464,
         "A_DN":"AR=ONT to ESP",
         "FROM_TYPE":"p",
         "LOGICALRESOURCE_UNIQUEID":null,
         "NETWORK_UNIQUEID":null,
         "N_DN":null,
         "PHYSICALRESOURCE_UNIQUEID":95365456,
         "RESOURCE_UNIQUEID":953654564,
         "R_DN":"ME=95365426",
         "R_NAME":"Optical Node Terminal",
         "R_PREFIX":"ME",
         "TO_LOGICALRESOURCE_UNIQUEID":null,
         "TO_NETWORK_UNIQUEID":null,
         "TO_PHYSICALRESOURCE_UNIQUEID":null,
         "TO_PLACE_UNIQUEID":65083834,
         "TO_P_DN":"ESP=20220422123515945336",
         "TO_RESOURCE_UNIQUEID":null,
         "TO_R_DN":null,
         "TO_R_NAME":null,
         "TO_R_PREFIX":null,
         "TO_TYPE":null
      }
   ],
   "entityInfo":[
      {  "UNIQUEID":95365453,
         "DNKEY":"ME",
         "PARENTDN":"None",
         "DISTINGUISHEDNAME":"ME=953654261",
         "ROOTDN_ENTITYID":"None",
         "ETYPE":"ET=ONT",
         "CATEGORY":"PHYSICAL_RESOURCE"
      }
   ]
};

function findNode(id){

}
function addNodes(nodeGroup){
     
    ggraph.getModel().beginUpdate();
    console.log(nodeGroup);

    try {
        var ninfo = nodeGroup.entityInfo[0]
        var mainNode =gNodes[ninfo.UNIQUEID]
        var message =nodeGroup.message;
        if(mainNode==null){
            mainNode =   addNode({id:ninfo.UNIQUEID, text: ninfo.DISTINGUISHEDNAME }) ;
            gNodes[ninfo.UNIQUEID]=mainNode;

        }
        for(var i =0; i < message.length; i ++){
            var data = message[i];
            var subNode =gNodes[data.RESOURCE_UNIQUEID]
            if(subNode ==null )
                subNode =   addNode({id:data.RESOURCE_UNIQUEID, text: data.R_DN }) ;
            
            gNodes[data.RESOURCE_UNIQUEID]=subNode;
            addLink(mainNode, subNode);
        }

                glayout.execute(gparent);
    }
    finally
    {
        // Updates the display
        ggraph.getModel().endUpdate();
    }

}




function addNode(data){
 // Load cells and layouts the graph  
            var v1 = ggraph.insertVertex(gparent, null, data.text, 0, 0, 10*data.text.length, 30); 
            //console.log(v1);
           // if(toNode!=null)
            // var e1 = ggraph.insertEdge(gparent, null, '', v1, toNode); 
            // Executes the layout
          //  glayout.execute(gparent);
          v1.id = data.id;
            return v1;
       
}



function addLink(fromNode,  toNode){ 
    var k = fromNode.id +">"+toNode.id;
    console.log(fromNode,  toNode)
    if(gEdge[k]==null) {
             var e1 = ggraph.insertEdge(gparent, null, '', fromNode, toNode); 
             gEdge[k] = e1;
    }
            // Executes the layout
          
       
}
        </script>
        </body>
    </html>
